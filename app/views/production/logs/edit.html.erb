<div class="container-fluid px-4 py-4" data-turbo-cache="false">
  <!-- í—¤ë” -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 style="font-weight: 600; color: #1d1d1f;">
      <i class="bi bi-pencil-square me-2"></i>ë°˜ì£½ì¼ì§€ ìˆ˜ì •
    </h4>
    <span class="badge bg-secondary" style="font-size: 0.9rem;">
      <%= @production_log.production_date.strftime('%Yë…„ %mì›” %dì¼ (%a)') %>
    </span>
  </div>

  <div class="card-modern">
    <div class="card-body p-4">
      <%
        form_url = production_log_path(@production_log)
        recipe = @production_log.recipe
        plan = @production_log.production_plan
      %>

      <%= form_with(model: @production_log, url: form_url, method: :patch, local: true) do |form| %>
        <% if @production_log.errors.any? %>
          <div class="alert alert-danger mb-4" role="alert">
            <h5 class="alert-heading mb-3">
              <i class="bi bi-exclamation-triangle me-2"></i>
              <%= pluralize(@production_log.errors.count, "error") %> prohibited this production log from being saved:
            </h5>
            <ul class="mb-0">
              <% @production_log.errors.each do |error| %>
                <li><%= error.full_message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <%= form.hidden_field :production_plan_id %>
        <%= form.hidden_field :finished_product_id %>
        <%= form.hidden_field :recipe_id %>
        <%= hidden_field_tag :from_status, @from_status %>

        <!-- ê¸°ë³¸ ì •ë³´ í‘œì‹œ -->
        <div class="row mb-3">
          <div class="col-md-4">
            <label class="form-label" style="font-weight: 500;">ì™„ì œí’ˆ</label>
            <div class="form-control-plaintext" style="font-weight: 600; color: #0071e3;">
              <%= @production_log.finished_product&.name || '-' %>
            </div>
          </div>
          <div class="col-md-4">
            <label class="form-label" style="font-weight: 500;">ë ˆì‹œí”¼</label>
            <div class="form-control-plaintext" style="font-weight: 600;">
              <%= @production_log.recipe&.name || '-' %>
            </div>
          </div>
          <div class="col-md-4">
            <label class="form-label" style="font-weight: 500;">ìƒì‚° ê³„íš</label>
            <div class="form-control-plaintext">
              <% if plan %>
                <%= number_with_delimiter(plan.quantity) %>ê°œ
              <% else %>
                <span class="text-muted">-</span>
              <% end %>
            </div>
          </div>
        </div>

        <!-- ê¸°ì •ë–¡ ì „ìš© í•„ë“œ ì„¹ì…˜ (ë ˆì‹œí”¼ í…Œì´ë¸” ìœ„ì— ë°°ì¹˜) -->
        <% if @production_log.finished_product&.name&.include?('ê¸°ì •ë–¡') %>
          <div class="gijeongddeok-fields-section mb-4">
            <h5 class="mb-3" style="color: #1d1d1f; font-weight: 600;">
              <i class="bi bi-clipboard-data me-2"></i>ê¸°ì •ë–¡ ìƒì‚° ì •ë³´
            </h5>

            <div class="card mb-3">
              <div class="card-header" style="background-color: #f5f5f7;">
                <h6 class="mb-0" style="font-weight: 500;">ğŸ“ ìƒì‚° ì •ë³´</h6>
              </div>
              <div class="card-body">
                <div class="row g-3">
                  <% @gijeongddeok_fields.each do |field| %>
                    <% next if field.field_name == 'makgeolli_consumption' %>
                    <div class="col-md-4">
                      <%= form.label field.field_name, field.label, class: "form-label" %>
                      <div class="input-group">
                        <% if field.field_name == 'dough_count' %>
                          <button type="button" class="btn btn-outline-secondary" onclick="adjustValue('production_log_<%= field.field_name %>', -0.5)">
                            <i class="bi bi-dash"></i>
                          </button>
                        <% end %>
                        <%= form.number_field field.field_name,
                                              step: field.field_name == 'dough_count' ? 0.5 : 0.1,
                                              class: "form-control",
                                              id: "production_log_#{field.field_name}" %>
                        <% if field.field_name == 'dough_count' %>
                          <button type="button" class="btn btn-outline-secondary" onclick="adjustValue('production_log_<%= field.field_name %>', 0.5)">
                            <i class="bi bi-plus"></i>
                          </button>
                          <span class="input-group-text">í†µ</span>
                        <% else %>
                          <span class="input-group-text">
                            <%= case field.field_name
                                when /temp$/
                                  'Â°C'
                                when 'yeast_amount', 'salt_amount', 'sugar_amount', 'steiva_amount'
                                  'g'
                                when 'water_amount'
                                  'L'
                                else
                                  ''
                                end %>
                          </span>
                        <% end %>
                      </div>
                    </div>
                  <% end %>
                </div>
              </div>
            </div>

          </div>
        <% end %>

        <% if recipe.present? && plan.present? %>
          <%
            # ë ˆì‹œí”¼ ë°°ìœ¨ ê³„ì‚°
            fpr = @production_log.finished_product.finished_product_recipes.find_by(recipe_id: recipe.id)
            weight_per_unit = fpr&.quantity || 0
            show_recipe_ingredients = weight_per_unit > 0
          %>
          <% if show_recipe_ingredients %>
            <%
              recipe_total = recipe.recipe_ingredients.where(row_type: ['ingredient', nil]).sum(:weight)
              recipe_total = recipe_total.zero? ? 1 : recipe_total
              multiplier = (plan.quantity.to_f * weight_per_unit) / recipe_total
              total_scaled = recipe_total * multiplier

              # ì¥ë¹„ ìµœëŒ€ ì‘ì—… ì¤‘ëŸ‰ í™•ì¸
              max_work_capacity = recipe.recipe_equipments.where.not(work_capacity: [nil, 0]).maximum(:work_capacity)
              max_work_capacity_g = max_work_capacity ? max_work_capacity * 1000 : nil

              if max_work_capacity_g && max_work_capacity_g > 0 && total_scaled > max_work_capacity_g
                batch_count = (total_scaled / max_work_capacity_g).ceil
              else
                batch_count = 1
              end
            %>

            <!-- ë ˆì‹œí”¼ ì¬ë£Œ í…Œì´ë¸” -->
            <div class="d-flex gap-3 mb-3 flex-wrap">
            <% batch_count.times do |batch_index| %>
              <div class="card recipe-ingredients-card" style="flex: 1; min-width: 250px;">
                <div class="card-body p-0">
                  <table class="table table-sm mb-0" style="font-size: 0.9rem;">
                    <thead>
                      <%
                        batch_completion_time = @production_log.batch_completion_times&.dig(batch_index.to_s)
                        if batch_completion_time
                          completion_datetime = Time.parse(batch_completion_time)
                          display_text = "#{completion_datetime.strftime('%m-%d')} #{completion_datetime.strftime('%H:%M')}"
                        else
                          display_text = "-- --:--"
                        end
                      %>
                      <tr>
                        <th style="padding: 0.6rem 1rem; font-weight: 600; color: #1d1d1f; background-color: #d6d8db;">
                          <div class="d-flex justify-content-between align-items-center">
                            <span>
                              <%= recipe.name %>
                              <% if batch_count > 1 %>
                                <span class="badge bg-secondary ms-2" style="font-size: 0.75rem;">
                                  <%= batch_index + 1 %>/<%= batch_count %>
                                </span>
                              <% end %>
                            </span>
                            <span class="production-datetime-header"
                                  data-production-log-id="<%= @production_log.id %>"
                                  data-batch-index="<%= batch_index %>"
                                  style="cursor: pointer; font-weight: 500; color: #6e6e73; margin-left: 1rem;"
                                  title="í´ë¦­í•˜ì—¬ ìˆ˜ì •">
                              <span class="datetime-display">
                                <%= display_text %>
                              </span>
                              <input type="date" class="datetime-edit datetime-edit-date" style="display: none; width: 100px; font-size: 0.875rem;">
                              <input type="time" class="datetime-edit datetime-edit-time" style="display: none; width: 80px; font-size: 0.875rem;">
                            </span>
                          </div>
                        </th>
                        <th class="text-end" style="padding: 0.6rem 1rem; font-weight: 600; color: #1d1d1f; background-color: #d6d8db;">
                          ì¤‘ëŸ‰
                        </th>
                        <th class="text-center" style="padding: 0.6rem 1rem; font-weight: 600; color: #1d1d1f; background-color: #d6d8db; min-width: 90px;">
                          ìœ í†µê¸°í•œ
                        </th>
                      </tr>
                    </thead>
                    <tbody>
                      <% running_subtotal = 0.0 %>
                      <% recipe.recipe_ingredients.order(:position).each do |ri| %>
                        <% if ri.row_type == 'subtotal' %>
                          <% scaled_subtotal = (running_subtotal * multiplier) / batch_count %>
                          <tr>
                            <td style="padding: 0.5rem 1rem; font-weight: 600; color: #1d1d1f; background-color: #d6d8db;">ì†Œê³„</td>
                            <td class="text-end" style="padding: 0.5rem 1rem; font-weight: 600; color: #0071e3; background-color: #d6d8db;">
                              <%= number_with_delimiter(scaled_subtotal.round(0)) %>
                            </td>
                            <td style="padding: 0.5rem 1rem; background-color: #d6d8db;"></td>
                          </tr>
                          <% running_subtotal = 0.0 %>
                        <% else %>
                          <% running_subtotal += ri.weight.to_f %>
                          <%
                            scaled_weight = (ri.weight.to_f * multiplier) / batch_count
                            field_key = "batch_#{batch_index}_ri_#{ri.id}"
                            saved_weights = @production_log.ingredient_weights || {}
                            display_weight = saved_weights[field_key].present? ? saved_weights[field_key].to_i : scaled_weight.round(0)
                          %>
                          <%
                            checked_ing = @production_log.checked_ingredients.find_by(recipe_id: recipe.id, ingredient_index: ri.position, batch_index: batch_index)
                            is_checked = checked_ing.present?
                            expiration_date = checked_ing&.expiration_date
                          %>
                          <tr class="ingredient-row"
                              data-recipe-id="<%= recipe.id %>"
                              data-ingredient-index="<%= ri.position %>"
                              data-batch-index="<%= batch_index %>"
                              data-checked="<%= is_checked %>"
                              style="cursor: pointer; user-select: none; <%= is_checked ? 'background-color: #c8e6c9;' : '' %>">
                            <td style="padding: 0.5rem 1rem; color: #1d1d1f; <%= is_checked ? 'background-color: #c8e6c9;' : '' %>">
                              <%= ri.display_name %>
                            </td>
                            <td class="text-end" style="padding: 0.5rem 1rem; color: #1d1d1f; font-weight: 500; <%= is_checked ? 'background-color: #c8e6c9;' : '' %>">
                              <%= number_with_delimiter(display_weight) %>
                              <input type="hidden" name="production_log[ingredient_weights][<%= field_key %>]"
                                     value="<%= display_weight %>">
                            </td>
                            <td class="text-center expiration-date-cell" style="padding: 0.5rem 1rem; color: #6e6e73; font-size: 0.85rem; <%= is_checked ? 'background-color: #c8e6c9;' : '' %>">
                              <% if expiration_date %>
                                <%= expiration_date.strftime('%y.%m.%d') %>
                              <% else %>
                                <span style="color: #c7c7cc;">-</span>
                              <% end %>
                            </td>
                          </tr>
                        <% end %>
                      <% end %>
                    </tbody>
                    <tfoot>
                      <tr>
                        <td style="padding: 0.6rem 1rem; font-weight: 700; color: #1d1d1f; background-color: #d6d8db; border-top: 1px solid #ced4da;">
                          <%= recipe.name %>ë¬´ê²Œ
                        </td>
                        <td class="text-end" style="padding: 0.6rem 1rem; color: #0071e3; font-weight: 700; font-size: 1rem; background-color: #d6d8db; border-top: 1px solid #ced4da;">
                          <%= number_with_delimiter((total_scaled / batch_count).round(0)) %>
                        </td>
                        <td style="padding: 0.6rem 1rem; background-color: #d6d8db; border-top: 1px solid #ced4da;"></td>
                      </tr>
                    </tfoot>
                  </table>
                </div>
                <!-- ì‘ì—…ì™„ë£Œ ë²„íŠ¼ (ê° í…Œì´ë¸”ë§ˆë‹¤) -->
                <%
                  is_batch_completed = @production_log.batch_completion_times&.key?(batch_index.to_s)
                %>
                <div class="d-flex justify-content-end mt-2 px-3 pb-3">
                  <button type="button"
                          class="btn btn-sm <%= is_batch_completed ? 'btn-secondary' : 'btn-success' %> btn-complete-work"
                          data-production-log-id="<%= @production_log.id %>"
                          data-batch-index="<%= batch_index %>"
                          style="font-weight: 500;"
                          <%= 'disabled' if is_batch_completed %>>
                    <i class="bi bi-<%= is_batch_completed ? 'check-circle-fill' : 'check-circle' %> me-2"></i><%= is_batch_completed ? 'ì‘ì—…ì™„ë£Œë¨' : 'ì‘ì—…ì™„ë£Œ' %>
                  </button>
                </div>
              </div>
            <% end %>
            </div>
          <% end %>
        <% end %>

        <!-- ë¹„ê³  -->
        <div class="mb-3">
          <%= form.label :notes, "ë¹„ê³ ", class: "form-label", style: "font-weight: 500;" %>
          <%= form.text_area :notes, class: "form-control", rows: 3,
                             placeholder: "ìƒì‚° ê³¼ì • ì¤‘ íŠ¹ì´ì‚¬í•­ì´ë‚˜ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)" %>
        </div>

        <div class="d-flex justify-content-end gap-2 mt-4">
          <%= form.submit "ìˆ˜ì •", class: "btn-modern btn-modern-primary" %>
          <%= link_to "ì·¨ì†Œ", production_logs_path(status: @from_status, date: @production_log.production_date), class: "btn-modern btn-modern-outline" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>
  // ë°˜ì£½ í†µìˆ˜ +/- ë²„íŠ¼ í•¸ë“¤ëŸ¬
  function adjustValue(fieldId, delta) {
    const field = document.getElementById(fieldId);
    if (field) {
      const currentValue = parseFloat(field.value) || 0;
      const newValue = currentValue + delta;
      field.value = Math.max(0, newValue).toFixed(1);
    }
  }

  // ì¬ë£Œ í–‰ ë”ë¸”í´ë¦­/ë”ë¸”íƒ­ - ì¬ë£Œ íˆ¬ì… ì™„ë£Œ í‘œì‹œ (ì´ë²¤íŠ¸ ìœ„ì„ ì‚¬ìš©)
  (function() {
    const CHECKED_COLOR = '#c8e6c9';
    const productionLogId = <%= @production_log.id %>;
    let lastTapTime = 0;
    let lastTapTarget = null;

    async function toggleRowColor(row) {
      const isChecked = row.dataset.checked === 'true';
      const recipeId = row.dataset.recipeId;
      const ingredientIndex = row.dataset.ingredientIndex;
      const batchIndex = row.dataset.batchIndex;

      // í† ê¸€í•  ìƒˆ ìƒíƒœ
      const newCheckedState = !isChecked;

      try {
        // ì„œë²„ì— ì²´í¬ ìƒíƒœ ì €ì¥
        const response = await fetch(`/production/logs/${productionLogId}/update_ingredient_check`, {
          method: 'PATCH',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRF-Token': document.querySelector('[name="csrf-token"]').content
          },
          body: JSON.stringify({
            recipe_id: recipeId,
            ingredient_index: ingredientIndex,
            batch_index: batchIndex,
            checked: newCheckedState
          })
        });

        const data = await response.json();

        if (data.success) {
          // í˜„ì¬ í´ë¦­í•œ í–‰ë§Œ ì—…ë°ì´íŠ¸ (íŠ¹ì • ë°°ì¹˜ë§Œ)
          const cells = row.querySelectorAll('td');
          if (newCheckedState) {
            cells.forEach(cell => {
              cell.style.backgroundColor = CHECKED_COLOR;
            });
            row.dataset.checked = 'true';
          } else {
            cells.forEach(cell => {
              cell.style.backgroundColor = '';
            });
            row.dataset.checked = 'false';
          }

          // ìƒíƒœ ë³€ê²½ ì‹œ ì•Œë¦¼ (ì„ íƒì‚¬í•­)
          if (data.status === 'completed') {
            console.log('ëª¨ë“  ì¬ë£Œ ì²´í¬ ì™„ë£Œ - ì‘ì—…ì™„ë£Œë¡œ ì´ë™ë˜ì—ˆìŠµë‹ˆë‹¤');
          } else if (data.status === 'in_progress') {
            console.log('ì‘ì—…ì¤‘ ìƒíƒœë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤');
          }
        } else {
          console.error('ì²´í¬ ìƒíƒœ ì €ì¥ ì‹¤íŒ¨');
        }
      } catch (error) {
        console.error('ì„œë²„ í†µì‹  ì˜¤ë¥˜:', error);
      }
    }

    document.addEventListener('dblclick', function(e) {
      if (e.target.tagName === 'INPUT') return;
      const row = e.target.closest('.ingredient-row');
      if (row) {
        e.preventDefault();
        toggleRowColor(row);
      }
    });

    document.addEventListener('touchend', function(e) {
      if (e.target.tagName === 'INPUT') return;
      const row = e.target.closest('.ingredient-row');
      if (!row) return;

      const currentTime = new Date().getTime();
      const tapLength = currentTime - lastTapTime;

      if (tapLength < 300 && tapLength > 0 && lastTapTarget === row) {
        e.preventDefault();
        toggleRowColor(row);
      }

      lastTapTime = currentTime;
      lastTapTarget = row;
    });

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì²´í¬ ìƒíƒœëŠ” ì„œë²„ ë Œë”ë§ìœ¼ë¡œ ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆìŒ
    // data-checked ì†ì„±ê³¼ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ì´ ì„œë²„ì—ì„œ ì˜¬ë°”ë¥´ê²Œ ë Œë”ë§ë˜ë¯€ë¡œ
    // ë³„ë„ì˜ ë³µì› ë¡œì§ì´ í•„ìš”í•˜ì§€ ì•ŠìŒ
  })();

  // ì‘ì—…ì™„ë£Œ ë²„íŠ¼ í•¸ë“¤ëŸ¬
  document.addEventListener('click', async function(e) {
    if (e.target.closest('.btn-complete-work')) {
      const button = e.target.closest('.btn-complete-work');
      const productionLogId = button.dataset.productionLogId;
      const batchIndex = button.dataset.batchIndex;

      if (!productionLogId || button.disabled) return;

      // í•´ë‹¹ ë°°ì¹˜ì˜ ëª¨ë“  ì¬ë£Œê°€ ì²´í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸
      const ingredientRows = document.querySelectorAll(`.ingredient-row[data-batch-index="${batchIndex}"]`);
      const uncheckedRows = Array.from(ingredientRows).filter(row => {
        return row.dataset.checked !== 'true';
      });

      if (uncheckedRows.length > 0) {
        alert(`ì²´í¬ë˜ì§€ ì•Šì€ ì¬ë£Œê°€ ${uncheckedRows.length}ê°œ ìˆìŠµë‹ˆë‹¤.\nëª¨ë“  ì¬ë£Œë¥¼ ì²´í¬í•œ í›„ ì‘ì—…ì™„ë£Œë¥¼ ì§„í–‰í•´ì£¼ì„¸ìš”.`);
        return;
      }

      // ì‘ì—…ì™„ë£Œ ì²˜ë¦¬
      try {
        const response = await fetch(`/production/logs/${productionLogId}/complete_work`, {
          method: 'PATCH',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRF-Token': document.querySelector('[name="csrf-token"]').content
          },
          body: JSON.stringify({
            batch_index: batchIndex
          })
        });

        const data = await response.json();

        if (data.success) {
          // í•´ë‹¹ ë°°ì¹˜ì˜ í—¤ë”ë§Œ ì°¾ì•„ì„œ ë‚ ì§œ/ì‹œê°„ ì—…ë°ì´íŠ¸
          const targetHeader = document.querySelector(`.production-datetime-header[data-batch-index="${batchIndex}"]`);
          if (targetHeader) {
            const display = targetHeader.querySelector('.datetime-display');
            if (display) {
              display.textContent = data.completion_time;
            }
          }

          // ë²„íŠ¼ ë¹„í™œì„±í™”
          button.disabled = true;
          button.innerHTML = '<i class="bi bi-check-circle-fill me-2"></i>ì‘ì—…ì™„ë£Œë¨';
          button.classList.remove('btn-success');
          button.classList.add('btn-secondary');
        } else {
          alert('ì‘ì—…ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨: ' + (data.errors || ['ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜']).join(', '));
        }
      } catch (error) {
        console.error('ì„œë²„ í†µì‹  ì˜¤ë¥˜:', error);
        alert('ì„œë²„ í†µì‹  ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    }
  });

  // ë‚ ì§œ/ì‹œê°„ í¸ì§‘ ê¸°ëŠ¥
  document.addEventListener('click', function(e) {
    const header = e.target.closest('.production-datetime-header');
    if (!header) return;

    const display = header.querySelector('.datetime-display');
    const dateInput = header.querySelector('.datetime-edit-date');
    const timeInput = header.querySelector('.datetime-edit-time');

    // í¸ì§‘ ëª¨ë“œë¡œ ì „í™˜
    if (display.style.display !== 'none') {
      const currentText = display.textContent.trim();
      const parts = currentText.split(' ');
      const currentDate = parts[0] !== '--' ? `2025-${parts[0]}` : new Date().toISOString().split('T')[0];
      const currentTime = parts[1] !== '--:--' ? parts[1] : new Date().toTimeString().slice(0, 5);

      dateInput.value = currentDate;
      timeInput.value = currentTime;

      display.style.display = 'none';
      dateInput.style.display = 'inline-block';
      timeInput.style.display = 'inline-block';
      dateInput.focus();
    }
  });

  // ë‚ ì§œ/ì‹œê°„ ì…ë ¥ í•„ë“œì—ì„œ í¬ì»¤ìŠ¤ ìƒì„ ë•Œ ì €ì¥
  document.addEventListener('blur', async function(e) {
    if (e.target.classList.contains('datetime-edit')) {
      const header = e.target.closest('.production-datetime-header');
      const display = header.querySelector('.datetime-display');
      const dateInput = header.querySelector('.datetime-edit-date');
      const timeInput = header.querySelector('.datetime-edit-time');

      // ì•½ê°„ì˜ ì§€ì—°ì„ ë‘ì–´ ë‹¤ë¥¸ ì…ë ¥ í•„ë“œë¡œ í¬ì»¤ìŠ¤ ì´ë™ í—ˆìš©
      setTimeout(async () => {
        if (document.activeElement !== dateInput && document.activeElement !== timeInput) {
          const productionLogId = header.dataset.productionLogId;

          if (productionLogId) {
            // ì„œë²„ì— ì €ì¥
            const formData = new FormData();
            formData.append('production_log[production_date]', dateInput.value);
            formData.append('production_log[production_time]', timeInput.value);

            try {
              const response = await fetch(`/production/logs/${productionLogId}`, {
                method: 'PATCH',
                headers: {
                  'X-CSRF-Token': document.querySelector('[name="csrf-token"]').content
                },
                body: formData
              });

              if (response.ok) {
                // í‘œì‹œ ì—…ë°ì´íŠ¸
                const date = new Date(dateInput.value);
                const displayDate = `${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
                display.textContent = `${displayDate} ${timeInput.value}`;
              }
            } catch (error) {
              console.error('ë‚ ì§œ/ì‹œê°„ ì €ì¥ ì˜¤ë¥˜:', error);
            }
          }

          // í‘œì‹œ ëª¨ë“œë¡œ ë³µê·€
          display.style.display = 'inline';
          dateInput.style.display = 'none';
          timeInput.style.display = 'none';
        }
      }, 200);
    }
  }, true);
</script>
