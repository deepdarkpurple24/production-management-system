#!/usr/bin/env bash
# Git post-merge hook
# Automatically runs after successful git pull or git merge

# Colors for output
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo ""
echo -e "${BLUE}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo -e "${BLUE}ğŸ”„ Git Pull ì™„ë£Œ - ìë™ í™˜ê²½ ë™ê¸°í™” ì‹œì‘${NC}"
echo -e "${BLUE}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
echo ""

# Run the setup script
if [ -f "bin/setup-after-pull" ]; then
  bash bin/setup-after-pull
  EXIT_CODE=$?

  if [ $EXIT_CODE -eq 0 ]; then
    echo ""
    echo -e "${BLUE}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo -e "${GREEN}âœ… í™˜ê²½ ë™ê¸°í™” ì™„ë£Œ!${NC}"
    echo ""
    echo -e "${YELLOW}âš ï¸  ë‹¤ìŒ ë‹¨ê³„:${NC}"
    echo -e "   1. í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ì„œë²„ê°€ ìˆë‹¤ë©´ ${YELLOW}Ctrl+C${NC}ë¡œ ì¤‘ì§€í•˜ì„¸ìš”"
    echo -e "   2. ${GREEN}bin/dev${NC} ëª…ë ¹ìœ¼ë¡œ ì„œë²„ë¥¼ ì¬ì‹œì‘í•˜ì„¸ìš”"
    echo -e "${BLUE}â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”${NC}"
    echo ""
  else
    echo ""
    echo -e "${YELLOW}âš ï¸  í™˜ê²½ ë™ê¸°í™” ì¤‘ ì¼ë¶€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.${NC}"
    echo -e "   ìœ„ì˜ ë©”ì‹œì§€ë¥¼ í™•ì¸í•˜ê³  í•„ìš”í•œ ì‘ì—…ì„ ìˆ˜ë™ìœ¼ë¡œ ì™„ë£Œí•˜ì„¸ìš”."
    echo ""
  fi
else
  echo -e "${YELLOW}âš ï¸  bin/setup-after-pull ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.${NC}"
  echo "   ë‹¤ìŒ ëª…ë ¹ì„ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰í•˜ì„¸ìš”:"
  echo "   1. bin/rails db:migrate"
  echo "   2. bundle install && yarn install"
  echo "   3. yarn build:css"
  echo "   4. bin/dev (ì„œë²„ ì¬ì‹œì‘)"
  echo ""
fi
